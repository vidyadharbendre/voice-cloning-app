# ================================
# FILE: docker/supervisord.conf
# ================================

[supervisord]
nodaemon=true
user=root

[program:voice-api]
command=/app/venv/bin/gunicorn app.main:app -k uvicorn.workers.UvicornWorker --bind 127.0.0.1:8000 --workers 4 --timeout 300
directory=/app
user=app
autorestart=true
redirect_stderr=true
stdout_logfile=/app/logs/gunicorn.log
stdout_logfile_maxbytes=50MB
stdout_logfile_backups=3

[program:nginx]
command=/usr/sbin/nginx -g "daemon off;"
autorestart=true
redirect_stderr=true
stdout_logfile=/var/log/nginx/stdout.log
stdout_logfile_maxbytes=50MB
stdout_logfile_backups=3

# ================================
# FILE: monitoring/prometheus.yml
# ================================

global:
  scrape_interval: 15s

scrape_configs:
  - job_name: 'voice-cloning-api'
    static_configs:
      - targets: ['localhost:8000']
    metrics_path: '/api/v1/metrics'
    scrape_interval: 30s
    scrape_timeout: 10s